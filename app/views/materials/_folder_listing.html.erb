<%- model_class = MaterialFolder -%>
<div class="page-header">
  <h1>Materials: <%= @folder.name %></h1>
</div>
<% if @folder.description %>
<div>
<h2 class="materials-description-title">Folder Description</h2>
  <p><%= @folder.description %></p>
  <hr />
</div>
<% end %>
<div>
  <% if can? :manage, Material %>
      <%= link_to t('.new', :default => t("Upload file")),
                  course_new_material_path(@course, @folder),
                  :class => 'btn btn-primary' %>
      <%= link_to t('.new', :default => t("Create folder")),
                  course_new_material_folder_path(@course, @folder),
                  :class => 'btn btn-primary' %>
  <% end %>
</div>
<div>
  <p></p>
</div>
<table class="table assignments materials-list-table">
  <thead>
    <tr>
      <th>Name</th>
      <th style="width: 20%">Date uploaded</th>
      <th style="width: 7%">Size</th>
      <% if can? :manage, Material %>
      <th style="width: 10%">&nbsp;</th>
      <% end %>
    </tr>
  </thead>

  <tbody class="table-hover">
    <% @folder.subfolders.each do |subfolder| %>
      <tr>
        <td>
          <%= link_to course_material_folder_path(@course, subfolder) do %>
            <%= render partial: "layouts/material_subfolder_title", locals: {subfolder: subfolder} %>
          <% end %>
        </td>

        <td>
          <%= subfolder.updated_at %>
        </td>

        <td>
          &nbsp;
        </td>

        <% if can? :manage, Material %>
          <td>
            <%= link_to course_material_folder_path(@course, subfolder), class: 'btn' do %>
              <i class="icon-edit"></i>
            <% end %>
            <%= link_to course_material_folder_path(@course, subfolder),
              method: :delete,
              data: { confirm: t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              class: 'btn btn-danger' do %>
                <i class="icon-trash"></i>
            <% end %>
          </td>
        <% end %>

      </tr>
    <% end %>

    <% @folder.files.each do |material| %>
      <tr>
        <td>
          <%= link_to course_material_path(@course, material) do %>
            <%= render partial: "layouts/material_title", locals: {material: material} %>
          <% end %>
        </td>

        <td>
          <%= datetime_format(material.updated_at) %>
        </td>

        <td>
          <%= material.filesize %>
        </td>

        <% if can? :manage, Material %>
          <td>
            <%= link_to edit_course_material_path(@course, material), class: 'btn' do %>
              <i class="icon-edit"></i>
            <% end %>
            <%= link_to course_material_path(@course, material),
              method: :delete,
              data: { confirm: t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              class: 'btn btn-danger' do %>
                <i class="icon-trash"></i>
            <% end %>
          </td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>
