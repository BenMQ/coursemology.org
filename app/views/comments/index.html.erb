<div class="page-header">
  <h1>Comments</h1>
</div>
<% require 'digest/md5' %>

<% if can? :see, :pending_comments %>
  <ul class="nav nav-tabs">
    <li class="<%= "active" if @tab == "pending" %>">
      <a href="<%= course_comments_url(@course) %>?_tab=pending" data-toggle="tab">Pending Comments (<%= @pending_comments.count %>)</a>
    </li>
    <li class="<%= "active" if @tab == "all" %>">
      <a href="<%= course_comments_url(@course) %>?_tab=all" data-toggle="tab">All Comments </a>
    </li>
    <li class="<%= "active" if @tab == "minepending" %>">
      <a href="<%=  course_comments_url(@course) %>?_tab=minepending" data-toggle="tab">My Students Pending (<%= @mine_pending_coments.count %>)</a>
    </li>
    <li class="<%= "active" if @tab == "mine" %>">
      <a href="<%=  course_comments_url(@course) %>?_tab=mine" data-toggle="tab">My Students</a>
    </li>
  </ul>
<% end %>

<% @topics.each do |topic| %>

    <% # currently the topic of the comment is only student answer for a question %>
    <%= render partial: "modules/commentable/commentable_std_answer", locals: { std_answer: topic } %>

    <%= render partial: "comments/list",
               locals: { comments: topic.comments_json,
                         target: topic,
                         header: "",
                         margin_left: "30px"} %>

<% end %>

<%= paginate @topics %>

<script>
    $('.mission-box').click(function(){
        document.location = $(this).attr('href');
    }).find('a').click(function(evt){
                evt.stopPropagation();
                return true;
            });

</script>
